/*! For license information please see index.umd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.amisWidget=t():e.amisWidget=t()}(this,(function(){return function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{getSchemaTpl:function(){return P.getSchemaTpl},registerAmisEditorPlugin:function(){return x},registerRendererByType:function(){return S}});var r=require("amis/lib/factory"),n=require("amis/lib/renderers/Form/Item"),o=require("amis/lib/renderers/Form/Options"),i=require("@babel/runtime/helpers/assertThisInitialized"),s=e.n(i),a=require("@babel/runtime/helpers/inheritsLoose"),c=e.n(a),u=require("react"),p=e.n(u);function f(e){if(e&&("function"==typeof e||"object"==typeof e))return function(t){function r(r){var n;return(n=t.call(this,r)||this).dom=void 0,n.instance=void 0,n.domRef=n.domRef.bind(s()(n)),n.instance="function"==typeof e?new e:e,n}c()(r,t);var n=r.prototype;return n.componentDidMount=function(){var e=this.instance.onMount;e&&e.apply(this.instance,[this.props])},n.componentDidUpdate=function(e){var t=this.instance.onUpdate;t&&t.apply(this.instance,[this.props,e])},n.componentWillUnmount=function(){var e=this.instance.onUnmout;e&&e.apply(this.instance,this.props)},n.domRef=function(e){this.instance.$root=this.dom=e,this._render()},n._render=function(){if(this.dom){var e=this.instance.template;"string"==typeof e?this.dom.innerHTML=e:"function"==typeof e&&(this.dom.innerHTML=e(this.props))}},n.render=function(){return p().createElement("div",{ref:this.domRef})},r}(p().Component)}require("jquery");var m=require("@babel/runtime/helpers/extends"),d=e.n(m),l=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),y=e.n(l),v=require("vue/dist/vue.min"),h=e.n(v),g=require("amis/lib/utils/helper"),b=["data"];function w(e){if(e&&("function"==typeof e||"object"==typeof e))return function(t){function r(e){var r;return(r=t.call(this,e)||this).domRef=void 0,r.vm=void 0,r.domRef=p().createRef(),r.resolveAmisProps=r.resolveAmisProps.bind(s()(r)),r}c()(r,t);var n=r.prototype;return n.componentDidMount=function(){var t=this,r=this.resolveAmisProps(),n=r.amisData,o=r.amisFunc,i=e="function"==typeof e?new e:e,s=i.data,a=y()(i,b);this.vm=new(h())(d()({data:(0,g.extendObject)(n,"function"==typeof s?s():s)},a)),Object.keys(o).forEach((function(e){var r=o[e];t.vm.$on(e,(function(e){return r&&r.apply(void 0,Array.isArray(e)?e:[e])}))})),this.domRef.current.appendChild(this.vm.$mount().$el)},n.componentWillUnmount=function(){this.vm.$destroy()},n.resolveAmisProps=function(){var e=this,t={},r={};return Object.keys(this.props).forEach((function(n){var o=e.props[n];"function"==typeof o?t[n]=o:r[n]=o})),{amisData:r,amisFunc:t}},n.componentDidUpdate=function(){var e=this;Object.keys(this.props).forEach((function(t){return"function"!=typeof e.props[t]&&(e.vm[t]=e.props[t])}))},n.render=function(){return p().createElement("div",{ref:this.domRef})},r}(p().Component)}var j,O,q="npm-custom",k="[amis-widget]";function S(e,t){if(e){var i,s,a,c={type:"",usage:j.renderer,weight:0,framework:O.react};if(t&&(i=t,"String"===Object.prototype.toString.call(i).slice(8,-1))?Object.assign(c,{type:t}):Object.assign(c,t),c&&!c.type)console.error(k+"自定义组件注册失败，自定义组件类型（type）不能为空。");else{c.type=(a=s=c.type,s?(s&&s.indexOf(q)<0&&(a="npm-custom-"+s),a):a),c.framework=function(e){var t=O.react;if(!e)return t;var r=e.toLowerCase().trim();switch(r){case"jquery":case"jq":r=O.jquery;break;case"vue":case"vue2":case"vue 2":case"vue2.0":case"vue 2.0":r=O.vue2;break;case"vue3":case"vue 3":case"vue3.0":case"vue 3.0":r=O.vue3,console.error("amis=widget不支持vue3.0技术栈，请改用vue3-amis-widget支持。");break;default:r=O.react}return r}(c.framework),c.usage=function(e){var t=j.renderer;if(!e)return t;var r=e.toLowerCase().trim();switch(r){case"renderer":case"renderers":default:r=j.renderer;break;case"formitem":case"form-item":case"form item":r=j.formitem;break;case"options":case"option":case"formoption":case"form-option":case"form option":r=j.options}return r}(c.usage);var u={renderer:r.Renderer,formitem:n.FormItem,options:o.OptionsControl},p={react:function(e){return e},vue2:w,vue3:w,jquery:f}[c.framework](e);u[c.usage]?(u[c.usage]({type:c.type,weight:c.weight})(p),console.info("注册了一个自定义amis组件:",{type:c.type,weight:c.weight,component:p,framework:c.framework,usage:c.usage})):console.error(k+"自定义组件注册失败，不存在"+c.usage+"自定义组件类型。")}}}!function(e){e.renderer="renderer",e.formitem="formitem",e.options="options"}(j||(j={})),function(e){e.react="react",e.vue2="vue2",e.vue3="vue3",e.jquery="jquery"}(O||(O={}));var P=require("amis-editor/dist/exports");function x(e,t){var r=function(e){function t(t){return e.call(this,t)||this}return c()(t,e),t}(P.BasePlugin);if(Object.assign(r.prototype,new e),Object.assign(r.prototype,t),function(e){var t=!1;if(!e)return!1;var r,n=new e;return n.rendererName?n.name?n.description?!n.tags||Array.isArray(n.tags)&&0===n.tags.length?console.error(k+"自定义插件注册失败，自定义组件分类（tags）不能为空。"):n.panelTitle?(n.icon||Object.assign(e.prototype,{icon:"fa fa-file-code-o"}),(r=e.prototype)&&(r.rendererName&&r.rendererName.indexOf(q)<0&&(r.rendererName="npm-custom-"+r.rendererName),r.previewSchema&&r.previewSchema.type&&r.previewSchema.type.indexOf(q)<0&&(r.previewSchema.type="npm-custom-"+r.previewSchema.type),r.scaffold&&Array.isArray(r.scaffold)?r.scaffold.map((function(e){return e.type.indexOf(q)<0&&(e.type="npm-custom-"+e.type),e})):r.scaffold&&r.scaffold.type&&r.scaffold.type.indexOf(q)<0&&(r.scaffold.type="npm-custom-"+r.scaffold.type)),t=!0):console.error(k+"自定义插件注册失败，自定义组件配置面板Title（panelTitle）不能为空。"):console.error(k+"自定义插件注册失败，自定义组件描述（description）不能为空。"):console.error(k+"自定义插件注册失败，自定义组件名称（name）不能为空。"):console.error(k+"自定义插件注册失败，关联渲染器（rendererName）不能为空。"),t}(r)){Object.assign(r.prototype,{isNpmCustomWidget:!0});var n=r.prototype;(0,P.registerEditorPlugin)(r),window&&window.postMessage&&window.postMessage({type:"amis-widget-register-event",eventMsg:k+"注册一个自定义amis-editor插件",editorPluginName:n.name},"*"),console.info(k+"注册了一个自定义amis-editor插件:",n)}return r}return t}()}));