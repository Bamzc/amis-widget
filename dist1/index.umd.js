/*! For license information please see index.umd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.amisWidget=t():e.amisWidget=t()}(this,(function(){return function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{getSchemaTpl:function(){return q.getSchemaTpl},registerAmisEditorPlugin:function(){return k},registerRendererByType:function(){return O}});var r=require("amis"),n=require("@babel/runtime/helpers/assertThisInitialized"),o=e.n(n),i=require("@babel/runtime/helpers/inheritsLoose"),s=e.n(i),a=require("react"),c=e.n(a);function u(e){if(e&&("function"==typeof e||"object"==typeof e))return function(t){function r(r){var n;return(n=t.call(this,r)||this).dom=void 0,n.instance=void 0,n.domRef=n.domRef.bind(o()(n)),n.instance="function"==typeof e?new e:e,n}s()(r,t);var n=r.prototype;return n.componentDidMount=function(){var e=this.instance.onMount;e&&e.apply(this.instance,[this.props])},n.componentDidUpdate=function(e){var t=this.instance.onUpdate;t&&t.apply(this.instance,[this.props,e])},n.componentWillUnmount=function(){var e=this.instance.onUnmout;e&&e.apply(this.instance,this.props)},n.domRef=function(e){this.instance.$root=this.dom=e,this._render()},n._render=function(){if(this.dom){var e=this.instance.template;"string"==typeof e?this.dom.innerHTML=e:"function"==typeof e&&(this.dom.innerHTML=e(this.props))}},n.render=function(){return c().createElement("div",{ref:this.domRef})},r}(c().Component)}require("jquery");var p=require("@babel/runtime/helpers/extends"),f=e.n(p),m=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),d=e.n(m),l=require("vue"),y=e.n(l),v=["data"];function h(e){if(e&&("function"==typeof e||"object"==typeof e))return function(t){function n(e){var r;return(r=t.call(this,e)||this).domRef=void 0,r.vm=void 0,r.domRef=c().createRef(),r.resolveAmisProps=r.resolveAmisProps.bind(o()(r)),r}s()(n,t);var i=n.prototype;return i.componentDidMount=function(){var t=this,n=this.resolveAmisProps(),o=n.amisData,i=n.amisFunc,s=e="function"==typeof e?new e:e,a=s.data,c=d()(s,v);this.vm=new(y())(f()({data:r.utils.extendObject(o,"function"==typeof a?a():a)},c)),Object.keys(i).forEach((function(e){var r=i[e];t.vm.$on(e,(function(e){return r&&r.apply(void 0,Array.isArray(e)?e:[e])}))})),this.domRef.current.appendChild(this.vm.$mount().$el)},i.componentWillUnmount=function(){this.vm.$destroy()},i.resolveAmisProps=function(){var e=this,t={},r={};return Object.keys(this.props).forEach((function(n){var o=e.props[n];"function"==typeof o?t[n]=o:r[n]=o})),{amisData:r,amisFunc:t}},i.componentDidUpdate=function(){var e=this;Object.keys(this.props).forEach((function(t){return"function"!=typeof e.props[t]&&(e.vm[t]=e.props[t])}))},i.render=function(){return c().createElement("div",{ref:this.domRef})},n}(c().Component)}var g,b,w="npm-custom",j="[amis-widget]";function O(e,t){if(e){var n,o,i,s={type:"",usage:g.renderer,weight:0,framework:b.react};if(t&&(n=t,"String"===Object.prototype.toString.call(n).slice(8,-1))?Object.assign(s,{type:t}):Object.assign(s,t),s&&!s.type)console.error(j+"自定义组件注册失败，自定义组件类型（type）不能为空。");else{s.type=(i=o=s.type,o?(o&&o.indexOf(w)<0&&(i="npm-custom-"+o),i):i),s.framework=function(e){var t=b.react;if(!e)return t;var r=e.toLowerCase().trim();switch(r){case"jquery":case"jq":r=b.jquery;break;case"vue":case"vue2":case"vue 2":case"vue2.0":case"vue 2.0":r=b.vue2;break;case"vue3":case"vue 3":case"vue3.0":case"vue 3.0":r=b.vue3,console.error("amis=widget不支持vue3.0技术栈，请改用vue3-amis-widget支持。");break;default:r=b.react}return r}(s.framework),s.usage=function(e){var t=g.renderer;if(!e)return t;var r=e.toLowerCase().trim();switch(r){case"renderer":case"renderers":default:r=g.renderer;break;case"formitem":case"form-item":case"form item":r=g.formitem;break;case"options":case"option":case"formoption":case"form-option":case"form option":r=g.options}return r}(s.usage);var a={renderer:r.Renderer,formitem:r.FormItem,options:r.OptionsControl},c={react:function(e){return e},vue2:h,vue3:h,jquery:u}[s.framework](e);a[s.usage]?(a[s.usage]({type:s.type,weight:s.weight})(c),console.info("注册了一个自定义amis组件:",{type:s.type,weight:s.weight,component:c,framework:s.framework,usage:s.usage})):console.error(j+"自定义组件注册失败，不存在"+s.usage+"自定义组件类型。")}}}!function(e){e.renderer="renderer",e.formitem="formitem",e.options="options"}(g||(g={})),function(e){e.react="react",e.vue2="vue2",e.vue3="vue3",e.jquery="jquery"}(b||(b={}));var q=require("amis-editor");function k(e,t){var r=function(e){function t(t){return e.call(this,t)||this}return s()(t,e),t}(q.BasePlugin);if(Object.assign(r.prototype,new e),Object.assign(r.prototype,t),function(e){var t=!1;if(!e)return!1;var r,n=new e;return n.rendererName?n.name?n.description?!n.tags||Array.isArray(n.tags)&&0===n.tags.length?console.error(j+"自定义插件注册失败，自定义组件分类（tags）不能为空。"):n.panelTitle?(n.icon||Object.assign(e.prototype,{icon:"fa fa-file-code-o"}),(r=e.prototype)&&(r.rendererName&&r.rendererName.indexOf(w)<0&&(r.rendererName="npm-custom-"+r.rendererName),r.previewSchema&&r.previewSchema.type&&r.previewSchema.type.indexOf(w)<0&&(r.previewSchema.type="npm-custom-"+r.previewSchema.type),r.scaffold&&Array.isArray(r.scaffold)?r.scaffold.map((function(e){return e.type.indexOf(w)<0&&(e.type="npm-custom-"+e.type),e})):r.scaffold&&r.scaffold.type&&r.scaffold.type.indexOf(w)<0&&(r.scaffold.type="npm-custom-"+r.scaffold.type)),t=!0):console.error(j+"自定义插件注册失败，自定义组件配置面板Title（panelTitle）不能为空。"):console.error(j+"自定义插件注册失败，自定义组件描述（description）不能为空。"):console.error(j+"自定义插件注册失败，自定义组件名称（name）不能为空。"):console.error(j+"自定义插件注册失败，关联渲染器（rendererName）不能为空。"),t}(r)){Object.assign(r.prototype,{isNpmCustomWidget:!0});var n=r.prototype;(0,q.registerEditorPlugin)(r),window&&window.postMessage&&window.postMessage({type:"amis-widget-register-event",eventMsg:j+"注册一个自定义amis-editor插件",editorPluginName:n.name},"*"),console.info(j+"注册了一个自定义amis-editor插件:",n)}return r}return t}()}));